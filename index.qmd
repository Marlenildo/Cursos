---
title: "üìò Curso de Estat√≠stica com R para Experimenta√ß√£o Agr√≠cola"
author: "Marlenildo Melo"
date: "2025-08-21"
lang: "pt-BR"
format:
  html:
    theme: cosmo
    include-in-header:
      - text: |
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: true
    toc_depth: 3
    number_sections: true
---


# Apresenta√ß√£o do Curso {.tabset}

Este material serve como guia para o curso **Estat√≠stica com R para Experimenta√ß√£o Agr√≠cola**.\
Cada aula cont√©m **explica√ß√µes te√≥ricas resumidas** e **c√≥digos pr√°ticos** para serem executados no RStudio.

## <i class="fa-brands fa-r-project"></i> Estrutura do Curso {#estrutura-do-curso}

### M√≥dulo 1 ‚Äì Introdu√ß√£o ao R e Organiza√ß√£o de Dados (Semanas 1-2)

**Objetivo:** Familiarizar o aluno com R, RStudio e a prepara√ß√£o correta dos dados.

#### Aula 1: Apresenta√ß√£o do curso + Instala√ß√£o do R e RStudio

-   O que √© R e RStudio
-   Instala√ß√£o passo a passo
-   Estrutura do RStudio (console, script, environment, plots, packages)

#### Aula 2: Primeiros passos no R

-   Comandos b√°sicos
-   Operadores aritm√©ticos e l√≥gicos
-   Criando e manipulando objetos

#### Aula 3: Instala√ß√£o e uso de pacotes

-   `install.packages()`, `library()`
-   Pacotes √∫teis: `tidyverse`, `readxl`, `agricolae`, `emmeans`, `broom`, `ggplot2`
-   Como procurar ajuda e documenta√ß√£o

#### Aula 4: Organiza√ß√£o de dados

-   Como estruturar dados no Excel (linhas = observa√ß√µes, colunas = vari√°veis)
-   Importa√ß√£o de arquivos (.csv, .xlsx, .txt)
-   Uso de `read.csv()`, `readxl::read_excel()`, `read.table()`
-   Verifica√ß√£o e limpeza dos dados (`head()`, `str()`, `summary()`)

------------------------------------------------------------------------

### M√≥dulo 2 ‚Äì Manipula√ß√£o e Explora√ß√£o de Dados (Semanas 3-4)

**Objetivo:** Aprender a organizar, transformar e explorar dados antes da an√°lise.

#### Aula 5: tidyverse para manipula√ß√£o

-   `dplyr`: `select()`, `filter()`, `mutate()`, `summarise()`, `group_by()`
-   `tidyr`: `pivot_longer()`, `pivot_wider()`

#### Aula 6: Estat√≠stica descritiva

-   M√©dias, desvios-padr√£o, erro-padr√£o
-   Tabelas resumo com `dplyr`
-   Visualiza√ß√µes iniciais: histogramas, boxplots, gr√°ficos de barras

#### Aula 7: Gr√°ficos com ggplot2

-   Estrutura do `ggplot2`
-   Gr√°ficos b√°sicos aplicados a dados de experimenta√ß√£o agr√≠cola
-   Personaliza√ß√£o de gr√°ficos

#### Aula 8: Introdu√ß√£o aos delineamentos experimentais

-   Delineamentos b√°sicos: DIC, DBC
-   Estrutura dos dados em experimenta√ß√£o agr√≠cola
-   Prepara√ß√£o dos dados no Excel para cada delineamento

------------------------------------------------------------------------

### M√≥dulo 3 ‚Äì An√°lise de Vari√¢ncia (ANOVA) (Semanas 5-8)

**Objetivo:** Ensinar a rodar ANOVA, verificar pressupostos e interpretar resultados, utilizando diferentes pacotes.

#### Aula 9: ANOVA em DIC

-   Fun√ß√µes base: `aov()`
-   ANOVA com `ExpDes.pt` (`dic()`)
-   ANOVA com `easyanova`

#### Aula 10: ANOVA em DBC

-   Fun√ß√µes base: `aov()`
-   ANOVA com `ExpDes.pt` (`dbc()`)
-   Compara√ß√£o da sa√≠da entre pacotes

#### Aula 11: Testes de pressupostos

-   Normalidade dos res√≠duos: `shapiro.test()`, `rstatix::shapiro_test()`
-   Homogeneidade: `bartlett.test()`, `car::leveneTest()`, `rstatix::levene_test()`
-   Interpreta√ß√£o pr√°tica

#### Aula 12: Testes de compara√ß√£o de m√©dias

-   `TukeyHSD()` (base R)
-   `ExpDes.pt` (j√° integrado √† ANOVA)
-   `emmeans` + `cld()`
-   `rstatix::t_test()` e `rstatix::anova_test()`

#### Aula 13: ANOVA em esquemas fatoriais

-   Dois fatores com `aov()`
-   Dois fatores com `ExpDes.pt::fat2.dic()` e `fat2.dbc()`
-   Interpreta√ß√£o das intera√ß√µes

#### Aula 14: ANOVA em parcela subdividida

-   Estrutura de dados
-   `ExpDes.pt::psub2.dbc()` (ou fun√ß√µes equivalentes)
-   Modelos mistos com `lme4::lmer()`

#### Aula 15: Como reportar resultados da ANOVA

-   `broom::tidy()` para organizar tabelas
-   Exporta√ß√£o de resultados com `rstatix` (`get_anova_table()`)
-   Apresenta√ß√£o de m√©dias e letras com `agricolae`, `emmeans` e `ExpDes.pt`

#### Aula 16: Exerc√≠cios pr√°ticos comparando pacotes

-   Mesmos dados analisados em `aov()`, `ExpDes.pt`, `easyanova` e `rstatix`
-   Discuss√£o: qual usar em cada situa√ß√£o

------------------------------------------------------------------------

### M√≥dulo 4 ‚Äì Regress√£o e Modelos (Semanas 9-11)

**Objetivo:** Introduzir regress√£o e aplica√ß√µes em experimenta√ß√£o agr√≠cola.

#### Aula 17: Introdu√ß√£o √† regress√£o linear

-   Conceito, ajuste com `lm()`
-   Gr√°ficos de regress√£o no `ggplot2`

#### Aula 18: Regress√£o polinomial

-   `lm(y ~ poly(x, 2))`
-   Aplica√ß√µes em curvas de dose, tempo, crescimento

#### Aula 19: Sele√ß√£o de modelos

-   Crit√©rios AIC e BIC
-   Compara√ß√£o de modelos

#### Aula 20: Regress√£o n√£o linear

-   `nls()`
-   Ajuste de curvas de resposta √† dose

#### Aula 21: Regress√£o log√≠stica (ex.: dados de presen√ßa/aus√™ncia)

-   `glm(family = binomial)`
-   Exemplos em fitossanidade e sobreviv√™ncia

#### Aula 22: Exerc√≠cios pr√°ticos de regress√£o com dados agr√≠colas

------------------------------------------------------------------------

### M√≥dulo 5 ‚Äì Encerramento e Projeto Final (Semana 12)

**Objetivo:** Consolidar o aprendizado com aplica√ß√µes pr√°ticas.

#### Aula 23: Como estruturar um relat√≥rio cient√≠fico no R

-   Uso do RMarkdown
-   Exportar para Word e PDF
-   Organiza√ß√£o dos resultados

#### Aula 24: Projeto final

Cada aluno analisa um banco de dados de experimenta√ß√£o agr√≠cola.

#### Entrega de relat√≥rio com:

-   Estrutura dos dados
-   ANOVA + testes de m√©dias ou regress√£o
-   Gr√°ficos e tabelas
-   Interpreta√ß√£o

------------------------------------------------------------------------

### üìÖ Cronograma Resumido (Atualizado)

-   **Semanas 1-2**: R, RStudio, pacotes, organiza√ß√£o/importa√ß√£o de dados\
-   **Semanas 3-4**: Manipula√ß√£o de dados, gr√°ficos, delineamentos\
-   **Semanas 5-8**: ANOVA com base R, `ExpDes.pt`, `easyanova` e `rstatix`\
-   **Semanas 9-11**: Regress√£o (linear, polinomial, n√£o linear, log√≠stica)\
-   **Semana 12**: Relat√≥rios e Projeto Final

------------------------------------------------------------------------

<br> <br>

## <i class="fas fa-code"></i> Exemplos de C√≥digos {#exemplos-de-c√≥digos}

### üîπ M√≥dulo 1 ‚Äì Introdu√ß√£o ao R e Organiza√ß√£o de Dados

#### Aula 1 ‚Äì Instala√ß√£o e primeiros passos

-   Instale o R e o RStudio em seu computador.\
-   Conhe√ßa os principais pain√©is do RStudio:
    -   *Console* (execu√ß√£o de comandos)\
    -   *Source* (script)\
    -   *Environment/History* (objetos)\
    -   *Plots/Packages/Help*

```{r}
# Verificando vers√£o do R
version

# Opera√ß√µes simples
2 + 2
10 / 3
sqrt(25)
```

------------------------------------------------------------------------

#### Aula 2 ‚Äì Objetos no R

```{r}
# Criando objetos
x <- 5
y <- 10
soma <- x + y
soma
```

------------------------------------------------------------------------

#### Aula 3 ‚Äì Pacotes

```{r}
#| message: false
#| warning: false

# Carregando pacotes
library(tidyverse)
library(readxl)
library(ExpDes.pt)
library(easyanova)
library(rstatix)
```

------------------------------------------------------------------------

#### Aula 4 ‚Äì Importa√ß√£o de Dados

```{r}
# Importando CSV
# dados_csv <- read.csv("meus_dados.csv", sep = ";", dec = ",")

# Importando Excel
# dados_excel <- readxl::read_excel("meus_dados.xlsx")

# Visualizando
# head(dados_csv)
# summary(dados_csv)
```

------------------------------------------------------------------------

### üîπ M√≥dulo 2 ‚Äì Manipula√ß√£o e Explora√ß√£o de Dados

#### Aula 5 ‚Äì Manipula√ß√£o com dplyr

```{r}
# Exemplo fict√≠cio
dados <- data.frame(
  tratamento = rep(c("T1", "T2", "T3"), each = 4),
  repeticao = rep(1:4, 3),
  produtividade = c(30, 32, 28, 31, 35, 36, 34, 37, 25, 27, 26, 28)
)

# Selecionar colunas e filtrar
dados %>% select(tratamento, produtividade) %>% filter(produtividade > 30)

# Resumo estat√≠stico
dados %>%
  group_by(tratamento) %>%
  summarise(
    media = mean(produtividade),
    sd = sd(produtividade)
  )
```

------------------------------------------------------------------------

#### Aula 6 ‚Äì Estat√≠stica Descritiva e Gr√°ficos

```{r}
# Histograma
ggplot(dados, aes(x = produtividade)) +
  geom_histogram(binwidth = 2, fill = "skyblue", color = "black")

# Boxplot
ggplot(dados, aes(x = tratamento, y = produtividade)) +
  geom_boxplot(fill = "orange")

```

------------------------------------------------------------------------

### üîπ M√≥dulo 3 ‚Äì An√°lise de Vari√¢ncia (ANOVA)

#### Aula 9 ‚Äì ANOVA em DIC

```{r}
# ANOVA usando aov()
modelo <- aov(produtividade ~ tratamento, data = dados)
summary(modelo)

# ANOVA usando ExpDes.pt
dic(
  trat = dados$tratamento,
  resp = dados$produtividade,
  quali = TRUE,
  mcomp = "tukey"
)

# ANOVA usando easyanova
easyanova::ea1(dados[-2], design = 1, plot = 2)
```

------------------------------------------------------------------------

#### Aula 11 ‚Äì Testes de Pressupostos

```{r}
# Normalidade
shapiro.test(residuals(modelo))
dados |> group_by(tratamento) |> rstatix::shapiro_test(produtividade)

# Homogeneidade
bartlett.test(produtividade ~ tratamento, data = dados)
rstatix::levene_test(produtividade ~ tratamento, data = dados)
```

------------------------------------------------------------------------

#### Aula 12 ‚Äì Compara√ß√µes de M√©dias

```{r}
# Tukey no R base
TukeyHSD(modelo)

# Emmeans
library(emmeans)
emmeans(modelo, pairwise ~ tratamento)

# rstatix
dados %>% anova_test(produtividade ~ tratamento)
dados %>% tukey_hsd(produtividade ~ tratamento)
```

------------------------------------------------------------------------

#### Aula 13 ‚Äì ANOVA Fatorial

```{r}
# Exemplo com dois fatores
dados2 <- expand.grid(
  adubacao = c("A1", "A2"),
  cultivar = c("C1", "C2", "C3"),
  rep = 1:4
)
set.seed(123)
dados2$produtividade <- rnorm(24, mean = 30, sd = 3)

# ANOVA
modelo2 <- aov(produtividade ~ adubacao * cultivar, data = dados2)
summary(modelo2)

# ExpDes.pt
fat2.dic(
  fator1 = dados2$adubacao,
  fator2 = dados2$cultivar,
  resp = dados2$produtividade,
  quali = c(TRUE, TRUE),
  mcomp = "tukey"
)
```

------------------------------------------------------------------------

### üîπ M√≥dulo 4 ‚Äì Regress√£o

#### Aula 17 ‚Äì Regress√£o Linear

```{r}
dose <- c(0, 50, 100, 150, 200)
prod <- c(20, 28, 35, 40, 38)
dados_reg <- data.frame(dose, prod)

modelo_reg <- lm(prod ~ dose, data = dados_reg)
a <- summary(modelo_reg)

# Coeficientes
coeficientes <- coef(modelo_reg)
intercepto <- round(coeficientes[1], 2) # sem sinal extra
slope <- formatC(coeficientes[2], format = "f", digits = 2, flag = "+") # sempre com sinal

# Estat√≠sticas do modelo
r2 <- round(a$r.squared, 4)
f_value <- a$fstatistic[1]
df1 <- a$fstatistic[2]
df2 <- a$fstatistic[3]
p_value_anova <- pf(f_value, df1, df2, lower.tail = FALSE)




# Equa√ß√£o no formato correto
equacao <- paste0("y = ", intercepto, slope, "x")

legenda <- paste0(
  equacao,
  "  R¬≤ = ", r2,
  "\nF = ", f_value,
  "; p = ", format.pval(p_value_anova, digits = 4, eps = 0.001)
)



dados_reg |>
  ggplot(aes(x = dose, y = prod)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  annotate("text",
           x = 100, y = 10,
           label = legenda,
           hjust = 0, size = 5) +
  labs(x = "Frequ√™ncia de irriga√ß√£o", y = "CRA (%)") +
  theme_bw() +
  theme(panel.grid = element_blank()) +
  ylim(0, 50)

```
------------------------------------------------------------------------


#### Aula 17 ‚Äì Regress√£o Quadr√°tica


```{r}
# Ajustar modelo de regress√£o quadr√°tica
modelo_quad <- lm(prod ~ dose + I(dose^2), data = dados_reg)
a <- summary(modelo_quad)
a
# Coeficientes da regress√£o quadr√°tica (com mais casas decimais)
coef_quad <- coef(modelo_quad)
intercepto <- formatC(coef_quad[1], format = "f", digits = 4)
linear     <- formatC(coef_quad[2], format = "f", digits = 4, flag = "+")
quadratico <- formatC(coef_quad[3], format = "f", digits = 4, flag = "+") 
# usei 6 casas para o termo quadr√°tico porque geralmente √© bem pequeno

# Estat√≠sticas do modelo
r2 <- round(a$r.squared, 4)
f_value <- a$fstatistic[1]
df1 <- a$fstatistic[2]
df2 <- a$fstatistic[3]
p_value_anova <- pf(f_value, df1, df2, lower.tail = FALSE)

# Equa√ß√£o para legenda
equacao <- paste0("y = ", intercepto, " ", linear, "x ", quadratico, "x¬≤")
legenda <- paste0(
  equacao,
  "  R¬≤ = ", r2,
  "\nF = ", round(f_value, 2),
  "; p = ", format.pval(p_value_anova, digits = 4, eps = 0.001)
)

# Gr√°fico
library(ggplot2)

regressao_quad <- ggplot(dados_reg, aes(x = dose, y = prod)) +
  geom_point(size = 3) +
  stat_smooth(
    method = "lm",
    formula = y ~ x + I(x^2),
    se = FALSE,
    color = "black"
  ) +
  annotate("text", x = 50, y = 10, label = legenda, hjust = 0, size = 5) +
  labs(x = "Dose", y = "Produ√ß√£o") +
  theme_bw() +
  theme(panel.grid = element_blank()) +
  ylim(0, 50)

# Exibir gr√°fico
regressao_quad

```



### üîπ M√≥dulo 5 ‚Äì Relat√≥rios e Projeto Final

#### Aula 23 ‚Äì Relat√≥rios com RMarkdown

-   Este pr√≥prio arquivo √© um exemplo.\
-   Pode ser exportado em HTML, Word ou PDF.

------------------------------------------------------------------------

### ‚úÖ Projeto Final

Analise um conjunto de dados agr√≠colas (real ou fornecido):\
- Estruture os dados no Excel/CSV.\
- Importe para o R.\
- Realize ANOVA (com `aov()`, `ExpDes.pt`, `easyanova` e `rstatix`).\
- Teste pressupostos.\
- Se necess√°rio, ajuste modelos de regress√£o.\
- Gere gr√°ficos com `ggplot2`.\
- Organize os resultados em relat√≥rio RMarkdown.

------------------------------------------------------------------------

<br>

## <i class="fas fa-user"></i> Quem Sou

Engenheiro Agr√¥nomo, Doutor em Fitotecnia

<i class="fa-solid fa-link"></i> [Linktree](https://linktr.ee/marlenildomelo)

<i class="fas fa-envelope"></i> [marlenildo\@gmail.com](mailto:marlenildo@gmail.com)

<i class="fab fa-whatsapp"></i> [(84) 98752-1095](https://wa.me/5584987521095)

<br>

------------------------------------------------------------------------

**Links √öteis**:

-   [Estrutura do Curso](#estrutura-do-curso)
-   [Exemplos de C√≥digos](#exemplos-de-c√≥digos)

<i class="fa-brands fa-r-project"></i> *Este documento foi criado utilizando a pr√≥pria linguagem R.*

------------------------------------------------------------------------